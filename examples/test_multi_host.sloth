-- Test multi-host execution using TaskDefinitions (legacy format)
-- Run: sloth-runner run -f test_multi_host.sloth --delegate-to lady-arch --delegate-to keite-guica

TaskDefinitions = {
    multi_host_test = {
        description = "Test execution on multiple hosts",
        tasks = {
            {
                name = "system_info",
                description = "Get system information from hosts",
                command = function()
                    log.info("=== Multi-Host Test ===")

                    -- Get hostname
                    local hostname_out, _, hostname_failed = exec.run("hostname")
                    if not hostname_failed then
                        local hostname = hostname_out:gsub("\n", "")
                        log.info("üìç Hostname: " .. hostname)
                    end

                    -- Get system info
                    local uname_out, _, uname_failed = exec.run("uname -a")
                    if not uname_failed then
                        log.info("üíª System: " .. uname_out:gsub("\n", ""))
                    end

                    -- Get date
                    local date_out, _, date_failed = exec.run("date")
                    if not date_failed then
                        log.info("üìÖ Date: " .. date_out:gsub("\n", ""))
                    end

                    -- Get uptime
                    local uptime_out, _, uptime_failed = exec.run("uptime")
                    if not uptime_failed then
                        log.info("‚è±Ô∏è  Uptime: " .. uptime_out:gsub("\n", ""))
                    end

                    log.info("‚úÖ Test completed on host")

                    return true, "Test completed successfully"
                end
            }
        }
    }
}