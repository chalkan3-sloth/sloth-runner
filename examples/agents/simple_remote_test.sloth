-- Exemplo simples de delegate_to com execuÃ§Ã£o no agent remoto

local remote_test = task("remote_test")
    :description("Teste simples no agent remoto")
    :command(function(this, params)
        log.info("ğŸš€ Executando teste remoto...")
        
        -- Obter informaÃ§Ãµes bÃ¡sicas do host
        local hostname, _, h_failed = exec.run("hostname")
        local whoami, _, w_failed = exec.run("whoami")
        local pwd, _, p_failed = exec.run("pwd")
        
        if not h_failed and not w_failed and not p_failed then
            log.info("âœ… Teste executado com sucesso!")
            log.info("ğŸ–¥ï¸ Host: " .. (hostname and hostname:gsub("\n", "") or "unknown"))
            log.info("ğŸ‘¤ User: " .. (whoami and whoami:gsub("\n", "") or "unknown"))
            log.info("ğŸ“ Directory: " .. (pwd and pwd:gsub("\n", "") or "unknown"))
            return true, "Teste remoto concluÃ­do com sucesso"
        else
            log.error("âŒ Falha no teste remoto")
            return false, "Falha no teste"
        end
    end)
    :delegate_to("ladyguica")  -- Executa no agent ladyguica
    :timeout("30s")
    :build()

-- Workflow simples
workflow.define("simple_remote_test")
    :description("Teste simples de execuÃ§Ã£o remota")
    :version("1.0.0")
    :tasks({ remote_test })
    :config({
        timeout = "1m"
    })
    :on_complete(function(success, results)
        if success then
            log.info("ğŸ‰ Teste remoto concluÃ­do com sucesso!")
        else
            log.error("ğŸ’¥ Teste remoto falhou!")
        end
        return true
    end)